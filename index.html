<!DOCTYPE html>
<link id=l>
<meta charset=utf-8>
<title>Quintessence</title>
<style>
html,body{-ms-touch-action:none;overflow: hidden;width:100%;height:100%;margin:0;font:16px/20px sans-serif;color:#FFF;cursor:default}
#w{width:724px;height:760px;position:absolute;top:0;left:50%;margin:0 -362px}
#m{position:absolute;width:660px;top:99px;margin:12px;background:rgba(0,0,0,.7);padding:20px;border-radius:4px}
#a{display:block}
#s{padding:10px;height:16px}
.b{display:block;border:solid 1px;color:#aaa;padding:10px;width:150px;margin:9px}
.b[onclick]{cursor:pointer;color:#fff;border-color:#fff}
.b[onclick]:hover{background:#fff;color:#000}
.b:link{color:#55acee;border-color:#55acee;text-decoration:none}
.b:link:hover{background:#55acee;color:#fff}
a{color:#fff}
h3{margin:0}
</style>
<body bgcolor=#333638>
<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1,user-scalable=no">
<div id=w>
<center id=m>Loading...</center>
<div id="s"></div>
<canvas id="a"></canvas>
</div>
<script>function e(e){return(Q[B]||0)[e]||Q.en[e]}function t(){m.style.display="block",m.innerHTML="<h1>Quintessence</h1><br><a class=b onclick=u()>"+e("bs")+((self.localStorage||{})["Quintessence.save"]?"<a class=b onclick=v()>":"<a class=b>")+e("bc")+"<a class=b onclick=T()>"+e("bh")+"<a class=b onclick=o()>"+e("ba")}function o(){m.innerHTML='<h2>Quintessence is brought to you by</h2><h3>Maxime Euzière</h3><small>Github: <a target="_blank" href="http://github.com/xem">@xem</a>, Twitter: <a target="_blank" href="http://twitter.com/MaximeEuziere">@MaximeEuziere</a></small><p>Code, Translation<h3>Anton Khlynovskiy</h3><small>Github: <a target="_blank" href="http://github.com/subzey">@subzey</a>, Twitter: <a target="_blank" href="http://twitter.com/subzey">@subzey</a></small><p>Idea, Code, Sfx, Gfx, Translation<h2>Thanks to</h2><p>Jim Herrero <i>for assistance in brainstorming.</i><p>Andrey Povajniy, Nikolay Podgrushiy, Sergey Kovalyov <i>for being passinate beta testers and giving valuable advices.</i></p><a class=b onclick=mainMenu()>'+e("bb")}function r(){var e=724,a=760,t=document.documentElement.clientWidth,o=document.documentElement.clientHeight;scale=Math.min(t/e,o/a),scale>1&&(scale=scale<<1>>1),["transform","-webkit-transform","-moz-transform","-o-transfrom","-ms-transform"].some(function(e){return e in w.style?(w.style[e+"-origin"]="362px 0",w.style[e]=1^scale?"scale("+scale+")":""):void 0})||(scale=1),R=e*scale,_=36*scale,G=(t-R)/2}function i(e){var a=document.createElement("audio");a.autoplay=!0,a.src=sa[e]}function n(){return Math.random()>(da-1e5)/9e5?[1,2,4,8][4*Math.random()|0]:1+14*Math.random()|0}function f(e){return e.toString(2).replace(/0/g,"").length}function c(a,t){Aa||(da+=a,s.innerHTML=e("s")+" <b>"+da,va.push({fn:y,affectedTiles:[],timestamp:+new Date,increment:a,idx:t}))}function u(){ga=[];do{for(var a=64;a--;)ga[a]=15&ga[a]||n();ma=[],va=[],s.innerHTML=da=0,x()}while(ma.length);da=0,s.innerHTML=e("s")+" <b>"+da,ba=0,Aa=0,ha=0,m.style.display="none";for(var a=64;a--;)ma.push({fn:g,affectedTiles:[a],timestamp:+new Date,soundPlayed:1,fallFrom:-1});ya=1,d(),q()}function v(){try{var a=JSON.parse(localStorage["Quintessence.save"]);ga=a.f.map(Number),da=+a.s,ba=0,s.innerHTML=e("s")+" <b>"+da,m.style.display="none",Aa=0,xa=[],q()}catch(t){alert("Save state is corrupted"),u()}}function d(){Aa||((self.localStorage||{})["Quintessence.save"]=JSON.stringify({f:ga,s:da}))}function T(){Aa=[{text:e("d")[0],newTiles:{59:1,51:2}},{text:e("d")[1],newTiles:{60:2,52:1}},{text:e("d")[2],newTiles:{61:1,53:2}},{newTiles:{}},{text:e("d")[3],newTiles:{58:12,59:12,60:4,61:12,62:12,52:8}},{newTiles:{}},{text:e("d")[4],newTiles:{59:15,60:4}},{newTiles:{}}],xa=[],ba=0,s.innerHTML="",q()}function h(e){e.preventDefault(),e=e.touches?e.touches[0]:e;var a=[e.pageX-G,e.pageY-_];return a=a.concat(a.map(b)),a[4]=8*a[3]+a[2],a}function b(e){return e=(724*e/R-2)/90,0>e||e>=8?void 0:0|e}function g(e){var a=e.affectedTiles%8,t=e.fallFrom,o=e.affectedTiles/8|0,r=new Date-e.timestamp,n=r*r/1e5+t;return o>n?(Z.drawImage(L[ga[e.affectedTiles]],90*a+7,90*n+7),1):void(ya&&(ya=0,i(3)))}function A(e){var a=(new Date-e.timestamp)/300;if(2>a){var t=e.affectedTiles[0]%8,o=e.affectedTiles[0]/8|0;if(Z.save(),Z.fillStyle="#FFF",1>a){e.soundPlayed||(e.soundPlayed=1,i(1));var r=Math.cos(a*Math.PI/2),n=e.affectedTiles[1]%8-t,s=(e.affectedTiles[1]/8|0)-o,l=t+n*r,f=o+s*r;Z.drawImage(H[e.tiles[0]],90*t+7,90*o+7),Z.drawImage(H[e.tiles[1]],90*l+7,90*f+7);var c=90*Math.max(t,l)+7,u=90*Math.max(o,f)+7,m=90*Math.min(t,l)+7+80,v=90*Math.min(o,f)+7+80;m>c&&v>u&&(Z.globalCompositeOperation="source-atop",Z.fillRect(c,u,m-c,v-u))}else Z.drawImage(H[ga[e.affectedTiles[0]]],90*t+7,90*o+7),Z.globalCompositeOperation="source-atop",Z.globalAlpha=2-a,Z.fillRect(90*t+7,90*o+7,80,80);return Z.restore(),1}}function p(e){var a=(new Date-e.timestamp)/1e3;if(e.soundPlayed||(e.soundPlayed=1,i(0)),1>a){var t=.18*Math.cos(15*a)*(1-a),o=e.affectedTiles[0]%8+t*e.sign*(1-e.direction),r=(e.affectedTiles[0]/8|0)+t*e.sign*e.direction,n=e.affectedTiles[0]==wa[4]?H:L;return Z.drawImage(n[ga[e.affectedTiles[0]]],90*o+7,90*r+7),1}}function C(e){Ma&&(Ma=0,i(2));var a=1-(new Date-e.timestamp)/300;if(a>0){if(e.q){var t=e.q%8,o=e.q/8|0;Z.drawImage(H[16],90*t+7,90*o+7)}Z.save(),Z.globalAlpha=a;for(var r=e.affectedTiles.length;r--;){var t=e.affectedTiles[r]%8,o=e.affectedTiles[r]/8|0;Z.drawImage(H[e.tile],90*t+7,90*o+7)}return Z.restore(),1}}function z(e){var a=(new Date-e.timestamp)/1e3;if(e.soundPlayed||(i(4),e.soundPlayed=1),1>a){var t=e.field[e.affectedTiles[0]];if(31==t){var o=e.affectedTiles[0],r=o%8,n=o/8|0;Z.save(),Z.globalAlpha=1-a,Z.fillStyle="#FFF",Z.fillRect(0,0,1e3,1e3),Z.globalAlpha=Math.min(2*(1-a),1),Z.drawImage(H[e.field[o]],90*r+7,90*n+7),Z.restore()}else for(var s=e.affectedTiles.length;s--;){Z.save();var o=e.affectedTiles[s],r=o%8,n=o/8|0;s||(Z.globalAlpha=Math.max(.7*(.7-a),0),8&t&&(Z.beginPath(),Z.arc(90*r+47,90*n+47,400*a,0,2*Math.PI,!1),Z.fillStyle="#F88",Z.fill()),2&t&&(Z.beginPath(),Z.fillStyle="#88F",Z.fillRect(90*r+47-1e3*a,90*n+7,2e3*a,80)),4&t&&(Z.beginPath(),Z.fillStyle="#FF0",Z.fillRect(90*r+7,90*n+47-1e3*a,80,2e3*a)),r+=.05*Math.sin(s+79*a)*a,n+=.05*Math.cos(s+69*a)*a),Z.globalAlpha=1-a,Z.drawImage(H[e.field[o]],90*r+7,90*n+7),Z.globalCompositeOperation="source-atop",0==e.destructionStyle[o]&&(Z.globalAlpha=a,Z.fillStyle="#0B0",Z.fillRect(90*r+7,90*n+7,80,80)),Z.restore()}return 1}}function y(e){var a=(new Date-e.timestamp-400)/600;if(0>a)return 1;if(1>a){Z.save(),Z.textAlign="center",Z.fillStyle="#FFFFFF";var t=e.idx%8,o=e.idx/8|0;Z.translate(90*t+47,90*o+57),Z.globalAlpha=Math.min(2-2*a,1);var r=Math.log(e.increment)*Math.cos(a/2);return Z.scale(r,r),Z.fillText(e.increment,0,15*-a),Z.restore(),1}}function M(e){if(!e.halt){var a=(new Date-e.timestamp)/500;if(2>a){var t=e.affectedTiles[0]%8,o=e.affectedTiles[0]>>3,r=e.affectedTiles[1]%8,i=e.affectedTiles[1]>>3;Z.save(),Z.drawImage(H[ga[e.affectedTiles[0]]],90*t+7,90*o+7),Z.drawImage(H[ga[e.affectedTiles[1]]],90*r+7,90*i+7),.5>a&&(Z.globalAlpha=2*a),a>1.5&&(Z.globalAlpha=2*(2-a)),Z.strokeStyle="#fff",Z.lineWidth=2,e.affectedTiles[1]-e.affectedTiles[0]>1?Z.strokeRect(90*t+2,90*o+2,90,180):Z.strokeRect(90*t+2,90*o+2,180,90);var n=1-Math.cos(2*Math.max(a-.5,0));return e.backwards?Z.translate(90*(t+(r-t)*n)+47,90*(o+(i-o)*n)+77):Z.translate(90*(r+(t-r)*n)+47,90*(i+(o-i)*n)+77),Z.lineJoin="round",Z.strokeStyle="#000",Z.fillStyle="#fff",Z.beginPath(),Z.moveTo(-4,30),Z.bezierCurveTo(-4,24,-14,4,-24,4),Z.bezierCurveTo(-19,-6,-5,9,-5,9),Z.lineTo(-4,-25),Z.bezierCurveTo(-4,-30,3,-30,3,-25),Z.lineTo(3,-2),Z.bezierCurveTo(3,-6,11,-5,11,-1),Z.lineTo(11,-1),Z.bezierCurveTo(11,-5,19,-4,19,0),Z.bezierCurveTo(22,-5,25,-1,24,10),Z.bezierCurveTo(24,20,18,22,18,30),Z.fill(),Z.stroke(),Z.restore(),1}}}function x(){Ta++;for(var e=[],a=6;a--;)for(var t=8;t--;){var o=8*t+a;ga[o]&&ga[o]==ga[o+1]&&ga[o]==ga[o+2]&&e.push([o,o+1,o+2]);var o=8*a+t;ga[o]&&ga[o]==ga[o+8]&&ga[o]==ga[o+16]&&e.push([o,o+8,o+16])}e:for(var a=e.length;a--;){for(var t=a;t--;)for(var r=0;r<e[a].length;r++)if(~e[t].indexOf(e[a][r])){e[t]=e[t].concat(e[a]);continue e}for(var i=e[a].sort(function(e,a){return e-a}),n=ga[i[0]],s={fn:C,timestamp:+new Date,tile:n},t=i.length;t--;)ga[i[t]]?ga[i[t]]=0:i.splice(t,1);s.affectedTiles=i,s.q=k(i),s.q&&(ga[s.q]=16),ma.push(s),Ma=1,c(f(n)*Ta*100*1<<i.length-2,s.q||i[1]),pa=1}e.length||(Ta=0)}function k(e){for(var a=5;a--;)for(var t=8;t--;){for(var o=1,r=a+8*t,i=5;i--;)o=o&&~e.indexOf(r+i);if(o)return r+2;for(var o=1,r=8*a+t,i=5;i--;)o=o&&~e.indexOf(r+8*i);if(o)return r+16}}function S(){for(var e=[],a=64;a--;)if(!ga[a]){for(var t=a;t>=0;t-=8)if(ga[t]){ga[a]=ga[t],ga[t]=0;var o=t/8|0;break}if(!ga[a]){Aa?Aa[0]&&(ga[a]=ga[a]||Aa[0].newTiles[a],delete Aa[0].newTiles[a]):ga[a]=n();var r=a%8;o=1.5*(e[r]=~-e[r])+.25*Math.random()}ga[a]&&(ma.push({fn:g,affectedTiles:[a],timestamp:+new Date,fallFrom:o}),ya=1)}}function F(){for(var e=64;e--;){var a=ga[e];if(a>16){var t={},o=[e];if(ma.push({fn:z,affectedTiles:o,timestamp:+new Date,field:ga.slice(),destructionStyle:t}),31==a)for(var r=64;r--;)ga[r]=0,o.push(r);else{if(ga[e]=0,1&a)for(var r=8;r;){var i=64*Math.random()|0;!t[i]&&ga[i]&&(t[i]=0,r--)}if(8&a)for(var r=2;~r--;)for(var n=2;~n--;){var i=e+8*r+n;8&~(e%8+n)&&ga[i]&&(t[i]=3)}for(var r=64;r--;)r>>3==e>>3&&ga[r]&&2&a&&(t[r]=1),r%8==e%8&&ga[r]&&4&a&&(t[r]=2);for(r in t)o.push(+r),ga[r]=0}c(500*f(a),e),pa=1}}}function D(){for(var e=[],a=8;a--;)for(var t=7;t--;){var o=8*a+t;!(ga[o]&ga[o+1])&&ga[o]*ga[o+1]&&e.push([o,o+1]);var o=8*t+a;!(ga[o]&ga[o+8])&&ga[o]*ga[o+8]&&e.push([o,o+8])}return e}function I(){a.width=724;for(var e=[],t=ma.length;t--;){var o=ma[t];o.fn(o)?e=e.concat(o.affectedTiles||[]):ma.splice(t,1)}for(var t=va.length;t--;){for(var o=va[t],r=0,i=o.affectedTiles.length;i--;)~e.indexOf(o.affectedTiles[i])&&(r=1);!r&&o.fn(o)?e=e.concat(o.affectedTiles||[]):va.splice(t,1)}Z.save(),Z.globalCompositeOperation="destination-over";for(var t=64;t--;)if(!~e.indexOf(t)&&ga[t]){var n=t%8,s=t/8|0,l=ha||t!=(Ca||wa)[4]?L:H;Z.drawImage(l[ga[t]],90*n+7,90*s+7)}Z.restore()}function q(){ka||ba||((self.requestAnimationFrame||setTimeout)(P,33),ka=1)}function P(){for(ka=0;xa&&!ma[0];)Aa&&(pa&&Aa.shift(),pa=0,Aa[0]&&Aa[0].text&&(m.innerHTML=Aa[0].text,delete Aa[0].text)),ha=1,[F,x,S][xa.length%3](),xa.push(ma.length),"0,0,0"==xa.slice(-3)&&(xa=0,ha=0,D().length||(Aa?t():(m.innerHTML="<h1>"+e("gm")+"</h1><p>"+e("gs")+"<h3>"+da+'</h3><a class=b target=_blank href="http://twitter.com/intent/tweet?text='+e("tw").replace(/%s/g,da)+"&url="+location+'&hashtags=QuintessenceGame">'+e("bt")+"<a class=b onclick=u()>"+e("br"),m.style.display="block",delete(self.localStorage||{})["Quintessence.save"]),ba=1,ha=1)),ma[0]&&d();(ma[0]||va[0])&&q(),I()}var B=((/[?&]lang=(.*)/.exec(location.search)||0)[1]||navigator.userLanguage||navigator.browserLanguage||navigator.language||"").replace(/^([a-z]+).*/,"$1").toLowerCase(),Q={en:{bs:"Start",bc:"Continue",bh:"How to play",br:"Start over",bt:"Tweet my score",ba:"Credits",bb:"Back",gm:"Game Over",gs:"Your final score is",tw:"I scored %s in Quintessence, a %23js13k game.",t:[,"Earth","Water","Mud","Air","Sand","Rain","Golem","Fire","Brimstone","Alcohol","Oil","Phlogiston","Diamond","Lightning","Life","Quintessence",,,,,,,,,,,,,,,"Harmony"],d:["This game is all about merging elements.<br/>Drag any of these two tiles with mouse (or finger on touch device) to merge into a new tile.","Perfect! You got the idea. Now try once again.<br/>Notice that some tiles cannot be merged, as tile cannot contain more than one of each basic element.","Three identical tiles in a row disappears.","Create five tiles in a row and get something special.","This is a Quintessence, the fifth element.<br>Merge it with other tile and see what happens."],s:"Score"},fr:{bs:"Démarrer",bc:"Continuer",bh:"Comment jouer",br:"Recommencer",bt:"Tweeter mon score",ba:"Credits",bb:"Reculer",gm:"Terminé",gs:"Votre score final est",tw:"J'ai fait un score de %s à Quintessence, un jeu %23js13k.",t:[,"Terre","Eau","Boue","Air","Sable","Pluie","Golem","Feu","Soufre","Alcool","Huile","Phlogiston","Diamant","Eclair","Vie","Quintessence",,,,,,,,,,,,,,,"Harmonie"],d:["Ce jeu consiste à mélanger des éléments.<br/>Déplacez une de ces deux cases avec la souris (ou le doigt sur un écran tactile) pour les malanger à une autre case.","Parfait! Vous avez compris l'idée. Maintenant, réessayez.<br/>Notez que quelques cases ne peuvent pas être mélangées, car une case ne peut pas contenir plus d'in exemplaire de chaque élément de base.","Trois cases identiques alignées disparaissent.","Alignez cinq cases identiques pour créer quelque chose de spécial.","Ceci est une Quintessence, le cinquième élément.<br>Mélangez-le avec d'autres cases pour voir ce qui se passe."],s:"Score"},ru:{bs:"Начать игру",bc:"Продолжить",bh:"Как играть",br:"Начать сначала",bt:"Поделиться в твиттере",ba:"Об авторах",bb:"Назад",gm:"Игра окончена",gs:"Вы набрали",tw:"Я набрал %s очков в Quintessence, игре %23js13k.",t:[,"Земля","Вода","Грязь","Воздух","Песок","Дождь","Голем","Огонь","Сера","Алкоголь","Масло","Флогистон","Бриллиант","Молния","Жизнь","Квинтэссенция",,,,,,,,,,,,,,,"Гармония"],d:["В этой игре нужно объединять элементы.<br/>Потяните любую из этих плиток мышкой (или пальцем, если у Вас тачевое устройство) чтобы объединить их в новую плитку.","Безупречно! Вы схватываете на лету. А теперь попробуйте ещё раз.<br/>Заметьте, некоторые плитки объединить не получится — в плитке может находиться базовых элементов не более, чем каждого по одному.","Три одинаковых плитки в ряд исчезают.","Соберите пять плиток в ряд, и получите кое-что особенное.","Это Квинтэссенция, пятый элемент.<br>Объедините её с лобой другой плиткой, и посмотрим, что из этого выйдет."],s:"Очки"}};t();var R,_,G;r(),window.onresize=r;for(var L=[],H=[],Z=a.getContext("2d"),E=64;E--;){a.width=80,a.height=80;for(var O=Z.createImageData(80,80),Y=6400;Y--;){var W=(Y/80|0)-39.5,V=Y%80-39.5,j=16*Math.random()|160;j-=V*V*V/1200,j-=W*W*W/1200,O.data[4*Y]=j+20*(8==E||4==E),O.data[4*Y+1]=j-5+20*(1==E||4==E),O.data[4*Y+2]=j-20+20*(2==E),O.data[4*Y+3]=9e3-3*(V*V+W*W)}for(var K=2;K--;){Z.putImageData(O,0,0),Z.globalCompositeOperation="source-atop";for(var N=6;--N;){Z.save(),Z.translate(4&N&&2*(5-N)-1,2&N&&2*(3-N)-1),Z.strokeStyle=Z.fillStyle=1&N?"#000":"#FFF",Z.globalAlpha=1^N?.3:K||.7,Z.textAlign="center",Z.fillText([e("t")[E]],40,70),K&&1==N&&(Z.strokeStyle="#CCC"),Z.beginPath(),Z.lineWidth=2,1==E&&(Z.moveTo(17,31),Z.bezierCurveTo(22,24,32,24,32,31),Z.bezierCurveTo(33,21,47,21,49,31),Z.bezierCurveTo(51,28,56,24,63,31),Z.moveTo(18,39),Z.lineTo(62,39),Z.moveTo(18,48),Z.lineTo(62,48)),2==E&&(Z.moveTo(20,45),Z.bezierCurveTo(40,60,40,30,60,45),Z.moveTo(20,35),Z.bezierCurveTo(40,50,40,20,60,35),Z.moveTo(20,25),Z.bezierCurveTo(40,40,40,10,60,25)),3==E&&(Z.moveTo(26,40),Z.bezierCurveTo(11,40,16,55,46,45),Z.bezierCurveTo(66,45,66,40,56,40),Z.moveTo(53,35),Z.arc(49,35,4,0,2*Math.PI,!1),Z.moveTo(40,30),Z.arc(33,30,7,0,2*Math.PI,!1)),4==E&&(Z.moveTo(20,35),Z.bezierCurveTo(20,32,60,38,60,35),Z.moveTo(20,27),Z.bezierCurveTo(60,27,65,17,50,17),Z.moveTo(20,43),Z.bezierCurveTo(60,43,65,53,50,53)),5==E&&(Z.moveTo(20,50),Z.bezierCurveTo(35,10,35,10,50,50),Z.bezierCurveTo(50,50,50,55,35,55),Z.moveTo(50,35),Z.bezierCurveTo(55,25,65,50,65,50)),6==E&&(Z.moveTo(32,25),Z.bezierCurveTo(20,20,15,38,20,38),Z.lineTo(60,38),Z.bezierCurveTo(65,38,63,8,45,19),Z.moveTo(48,27),Z.bezierCurveTo(48,17,32,23,32,30),Z.moveTo(32,42),Z.lineTo(28,51),Z.moveTo(42,42),Z.lineTo(37,53),Z.moveTo(52,42),Z.lineTo(48,51)),7==E&&(Z.moveTo(20,55),Z.bezierCurveTo(20,35,25,40,30,35),Z.bezierCurveTo(38,30,25,20,40,20),Z.bezierCurveTo(55,20,42,30,50,35),Z.bezierCurveTo(55,40,60,35,60,55),Z.moveTo(31,55),Z.bezierCurveTo(31,45,28,46,27,46),Z.moveTo(49,55),Z.bezierCurveTo(49,45,52,46,53,46)),8==E&&(Z.moveTo(25,40),Z.bezierCurveTo(25,60,55,60,55,40),Z.bezierCurveTo(55,30,40,25,40,15),Z.bezierCurveTo(30,25,45,40,40,40)),9==E&&(Z.moveTo(33,23),Z.lineTo(42,27),Z.lineTo(45,58),Z.lineTo(20,43),Z.lineTo(30,20),Z.lineTo(42,14),Z.lineTo(55,20),Z.lineTo(68,47),Z.lineTo(50,55)),10==E&&(Z.moveTo(32,17),Z.bezierCurveTo(38,17,37,17,37,35),Z.bezierCurveTo(20,47,15,52,40,52),Z.bezierCurveTo(65,52,60,47,43,35),Z.bezierCurveTo(43,17,42,17,48,17)),11==E&&(Z.moveTo(25,18),Z.bezierCurveTo(25,10,55,10,55,18),Z.bezierCurveTo(55,26,25,26,25,18),Z.moveTo(55,48),Z.bezierCurveTo(55,56,25,56,25,48),Z.moveTo(27,47),Z.lineTo(27,24),Z.moveTo(53,47),Z.lineTo(53,24),Z.moveTo(40,30),Z.bezierCurveTo(30,50,50,50,40,30)),12==E&&(Z.moveTo(37,10),Z.bezierCurveTo(47,20,17,35,37,45),Z.moveTo(43,54),Z.bezierCurveTo(33,44,63,29,43,19)),13==E&&(Z.moveTo(48,30),Z.lineTo(32,30),Z.lineTo(20,27),Z.lineTo(30,17),Z.lineTo(50,17),Z.lineTo(60,27),Z.lineTo(40,52),Z.lineTo(23,32)),14==E&&(Z.moveTo(35,13),Z.lineTo(30,33),Z.lineTo(40,35),Z.lineTo(31,51),Z.lineTo(55,31),Z.lineTo(42,28),Z.lineTo(50,15),Z.lineTo(40,14)),15==E&&(Z.moveTo(43,19),Z.bezierCurveTo(48,13,55,13,60,18),Z.bezierCurveTo(75,33,40,53,40,53),Z.bezierCurveTo(40,53,5,33,20,18),Z.bezierCurveTo(40,8,45,31,45,35)),16==E&&Z.arc(40,40,23,2.5,6.9,!1),Z.stroke(),16&E&&(Z.beginPath(),Z.arc(40,40,8,0,2*Math.PI,!1),1==N&&31!=E&&(Z.fillStyle="#FFF"),Z.fill());for(var U=4;U--;)Z.beginPath(),E>16&&31>E&&((1&U?4&E:2&E)&&(Z.moveTo(40,8),Z.bezierCurveTo(48,33,32,33,40,8)),8&E&&(Z.moveTo(25,25),Z.bezierCurveTo(25,40,40,30,25,25)),1&E&&(Z.moveTo(11,31),Z.bezierCurveTo(7,27,27,7,31,11),Z.lineTo(11,31))),Z.stroke(),E&1<<U&&(Z.beginPath(),Z.moveTo(0,0),Z.lineTo(0,35),Z.bezierCurveTo(10,35,-4,5,12,12),Z.bezierCurveTo(5,-4,35,10,35,0),1==N&&31!=E&&(Z.fillStyle=["#0B0","#00C","#DD0","#C00"][U]),Z.fill()),Z.translate(40,40),Z.rotate(Math.PI/2),Z.translate(-40,-40);Z.restore()}var X=new Image;X.src=a.toDataURL(),K?H[E]=X:(16==E&&(l.href=X.src,l.rel="shortcut icon"),L[E]=X)}}a.width=724,a.height=724;for(var J=80,$=2,ea=1,aa=4,ta=$+J+$,oa=ea+ta+ea+aa,ra=8*(ea+ta+ea)+9*aa,O=Z.createImageData(ra,ra),Y=ra*ra;Y--;){var ia=Y%ra%oa-aa,na=(Y/ra%oa|0)-aa,j=12*Math.random()|96;ia>=0&na>=0&&(j-=20,(0==ia||0==na)&&(j-=30),(ia==ea+ta||na==ea+ta)&&(j+=30)),O.data[4*Y]=j,O.data[4*Y+1]=j+=3,O.data[4*Y+2]=j+=5,O.data[4*Y+3]=255}Z.putImageData(O,0,0),a.style.background="url("+a.toDataURL()+")";for(var sa=[],la=0,fa=atob("UklGRoTqAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YWDqAAA=");la++<3e4;){for(var ca=0,ua=9;--ua;)ca+=Math.sin(la/15/ua)*Math.cos(ua)*ua*ua*300*(6e4/(3e4+la)-1);fa+=String.fromCharCode(255&ca,ca>>>8&255)}sa.push("data:audio/wav;base64,"+btoa(fa));for(var la=0,fa=atob("UklGRoTqAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YWDqAAA=");la++<3e4;){for(var ca=0,ua=9;--ua;)ca+=Math.sin(la/25/ua)*Math.sin(ua/2)*6e3*(6e4/(3e4+la)-1);fa+=String.fromCharCode(255&ca,ca>>>8&255)}sa.push("data:audio/wav;base64,"+btoa(fa));for(var la=0,fa=atob("UklGRoTqAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YWDqAAA=");la++<3e4;){for(var ca=0,ua=9;--ua;)ca+=Math.sin(la/15/ua)*Math.cos(ua)*7e3*(6e4/(3e4+la)-1);fa+=String.fromCharCode(255&ca,ca>>>8&255)}sa.push("data:audio/wav;base64,"+btoa(fa));for(var la=0,fa=atob("UklGRoTqAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YWDqAAA=");la++<3e4;){for(var ca=0,ua=9;--ua;)ca+=Math.sin(la/180*ua)*Math.sin(ua)/ua*10*(30050/(la+50));fa+=String.fromCharCode(255&ca,ca>>>8&255)}sa.push("data:audio/wav;base64,"+btoa(fa));for(var la=0,fa=atob("UklGRoTqAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YWDqAAA=");la++<3e4;){for(var ca=0,ua=9;--ua;)ca+=Math.sin(ua/(la+300)*5e3)*ua*Math.cos(la/30)*Math.sin(la/40)*1e3*(6e4/(3e4+la)-1);fa+=String.fromCharCode(255&ca,ca>>>8&255)}sa.push("data:audio/wav;base64,"+btoa(fa));var ma=[],va=[],da=0,Ta=0,ha=1,ba=1,ga=[],Aa=0,pa=0,wa=0,Ca=0,za=0;document.ontouchmove=document.onmousemove=function(e){var a=h(e);if(wa[4]==a[4]||q(),wa=a,Ca&&!ma[0]){for(var t,o=wa[0]-Ca[0],r=wa[1]-Ca[1],i=va.length;i--;)va[i].fn==M&&(t=va[i]);if(o*o+r*r>R*R/100){var n=+(1>o/r*o/r),s=wa[n]-Ca[n]>0?1:-1,l=Ca[2+n]+s,u=0;8&l&&(u=1);var m=8*(n?l:Ca[3])+(n?Ca[2]:l);if((ga[m]&ga[Ca[4]]||!ga[m])&&(u=1),u){if(va.push({fn:p,affectedTiles:[Ca[4]],timestamp:+new Date,direction:n,sign:s}),++za>2&&!t){var v=D();va.push({fn:M,affectedTiles:v[Math.random()*v.length|0]||[],timestamp:+new Date,backwards:Math.random()<.5})}}else za=0,t&&(t.halt=1),ma=[{fn:A,affectedTiles:[m,Ca[4]],timestamp:+new Date,tiles:[ga[m],ga[Ca[4]]]}],ga[m]=ga[m]|ga[Ca[4]],ga[Ca[4]]=0,xa=xa||[],c(10*f(ga[m]),m),ha=1,pa=1,d();q(),Ca=0}}},document.onmouseout=function(){wa=0,q()},document.ontouchstart=document.onmousedown=function(e){if(!ha){var a=h(e);Ca[4]==a[4]||q(),Ca=ga[a[4]]&&a}},document.ontouchend=document.onmouseup=function(){Ca=0,q()};var ya=1,Ma=1,xa=[],ka=0</script>
